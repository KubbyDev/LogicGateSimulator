<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Logic Gate Simulator</title>
    <link rel="stylesheet" type="text/css" href="Simulator/Style.css"/>
</head>
<body>

<canvas id="canvas" width="1400" height="700"></canvas>

<div id="popup_bg" onclick="Popup.closeIfClickedOnBackground()">
    <div id="popup_main_div">
        <!-- Filled by the program when needed -->
    </div>
</div>

<script src="Simulator/Gate/GateFactory.js"></script>
<script src="Simulator/Gate/Connection.js"></script>
<script src="Simulator/Gate/Gate.js"></script>
<script src="Simulator/Gate/Special/Clock.js"></script>
<script src="Simulator/Gate/Special/Output.js"></script>
<script src="Simulator/Gate/Special/Switch.js"></script>
<script src="Simulator/Gate/Special/Input.js"></script>
<script src="Simulator/Gate/Special/ConnectionNode.js"></script>
<script src="Simulator/Gate/Special/CustomGate.js"></script>
<script src="Simulator/Gate/SerializerParser.js"></script>
<script src="Simulator/Gate/Save.js"></script>

<script src="Simulator/Interface/Interface.js"></script>
<script src="Simulator/Interface/Button.js"></script>
<script src="Simulator/Interface/UserInteraction.js"></script>
<script src="Simulator/Interface/Popup.js"></script>
<script src="Simulator/Interface/Modes/BuildMode.js"></script>
<script src="Simulator/Interface/Modes/WiringMode.js"></script>
<script src="Simulator/Interface/Modes/InteractionMode.js"></script>

<script src="Simulator/Tools.js"></script>

<script>

    //TODO:
    // snap auto sur la connection la plus proche
    // serveur pour update auto des customgate
    // Centrer gates au moemnt d'un load
    // Supprimer les nodes dans les custom gates
    /* Cleanup (comments + robustesse + generalisation de code)
    const instead of let if possible
    refaire le menu build en plus propre et general
    passer les constantes dans des classes
    gate drawing tools in GateFactory */
    // Setup babel
    // manuel d'utilisation dans le readme

    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const popupBackground = document.getElementById("popup_bg");

    let gates = []; // List of the gates in the simulation world
    let framesToCalculate = -1; // -1: calculate frames without stopping, 0+: calculate x frames and stop

    Interface.init();

    setInterval(() => {

        Interface.clear();
        Interface.update();

        if(framesToCalculate !== 0)
            Gate.updateAll(gates);
        if(framesToCalculate > 0)
            framesToCalculate--;

        Gate.drawAll(gates);
        Interface.draw();

    }, 1);

</script>

</body>
</html>