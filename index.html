<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Logic Gate Simulator</title>
    <link rel="stylesheet" type="text/css" href="Simulator/Style.css"/>
</head>
<body>

<canvas id="canvas" width="1400" height="700"></canvas>

<div id="popup_bg" onclick="Popup.closeIfClickedOnBackground()">
    <div id="popup_main_div">
        <!-- Filled by the program when needed -->
    </div>
</div>

<!-- This HTML went through Babel and javascript-minifier, so its not readable -->
<!-- for a human being. The readable version of the code can be found here: -->
<!-- https://github.com/KubbyDev/LogicGateSimulator/tree/master/Simulator -->
<script>
"use strict";var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),popupBackground=document.getElementById("popup_bg"),gates=[],framesToCalculate=-1;function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}setTimeout(function(){Interface.init(),setInterval(function(){for(var t=Date.now(),e=0;e<10&&Date.now()-t<10;)rightArrowPressed&&framesToCalculate>=0&&(framesToCalculate=Math.max(framesToCalculate,1)),0!==framesToCalculate&&Gate.updateAll(gates),framesToCalculate>0&&framesToCalculate--,e++},10),setInterval(function(){Interface.clear(),Interface.update(),Gate.drawAll(gates),Interface.draw()},50)},100);var Tools=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"fillCircle",value:function(t,e,n,r,o,i){ctx.beginPath(),ctx.fillStyle=r||"#ffffff",ctx.arc(t,e,n,0,2*Math.PI),ctx.fill(),(void 0===o||o)&&(ctx.lineWidth=1,ctx.strokeStyle=i||"#000000",ctx.stroke())}},{key:"resizeCanvas",value:function(){canvas.width=window.innerWidth+1,setTimeout(function(){canvas.height=window.innerHeight+1},0)}},{key:"download",value:function(t,e){var n=new Blob([t],{type:"text/plain"}),r=window.document.createElement("a");r.href=window.URL.createObjectURL(n),r.download=e||"LogicGateSimulator",r.click()}},{key:"sqr",value:function(t){return t*t}},{key:"getGateAtPosition",value:function(t,e){var n,r=_createForOfIteratorHelper(gates);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(Math.abs(t-o.x)<o.width/2&&Math.abs(e-o.y)<o.height/2)return o}}catch(t){r.e(t)}finally{r.f()}return null}}]),t}();function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Array.prototype.remove=function(t){return this.filter(function(e){return e!==t})},Array.prototype.removeAll=function(t){return this.filter(function(e){return!t.includes(e)})},window.onresize=Tools.resizeCanvas,Tools.resizeCanvas();var Connection=function(){function t(e,n){_classCallCheck(this,t),this.destination=n,this.origin=e}return _createClass(t,[{key:"getInput",value:function(t){if(this.destination instanceof ConnectionNode){if(void 0===t&&(t=[]),t.includes(this.destination.id))return;return t.push(this.destination.id),this.destination.inputs[0]?this.destination.inputs[0].getInput(t):void 0}return this.destination}},{key:"getValue",value:function(){return void 0!==this.getInput()&&void 0!==this.getInput().output&&this.getInput().output}},{key:"draw",value:function(e){var n=this.origin.getInputPosition(e),r=this.destination.getOutputPosition();ctx.beginPath(),ctx.moveTo(n[0]+this.origin.width/4,n[1]);var o,i=_createForOfIteratorHelper(this.calculateIntermediates(r[0],r[1],n[0],n[1]));try{for(i.s();!(o=i.n()).done;){var a=o.value;ctx.lineTo(a[0],a[1])}}catch(t){i.e(t)}finally{i.f()}ctx.lineTo(r[0],r[1]),ctx.lineWidth=Interface.connectionWidth,ctx.strokeStyle=this.getValue()?t.upColor:t.downColor,ctx.stroke()}},{key:"calculateIntermediates",value:function(t,e,n,r){var o=(n+t)/2,i=(r+e)/2;return n-Interface.connectionGap<t+Interface.connectionGap?[[n-Interface.connectionGap,r],[n-Interface.connectionGap,i],[t+Interface.connectionGap,i],[t+Interface.connectionGap,e]]:[[o,r],[o,e]]}}]),t}();function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}_defineProperty(Connection,"downColor","#d3d3d3"),_defineProperty(Connection,"upColor","#ffbf00");var Gate=function(){function t(){_classCallCheck(this,t),this.activation=function(){return!0},this.inputs=[],this.prevOutput=!1,this.output=!1,this.maxInputs=0,this.maxOutputs=1,this.id=-1,this.x=10,this.y=10,this.width=20,this.height=20,this.color="#379f1f",this.type="",this.name="",this.fontSize=8,this.hideName=!1}return _createClass(t,[{key:"setFonctionnalProperties",value:function(t,e,n,r){return e&&(this.activation=e),this.maxInputs=void 0!==r?r:0,this.setInputs(void 0!==n?n:[]),this.type=t,this}},{key:"setInputs",value:function(t){var e=this;return this.inputs=t.map(function(t){return new Connection(e,t)}).slice(0,this.maxInputs),this}},{key:"setHideName",value:function(t){return this.hideName=t,this}},{key:"addInput",value:function(t,e){void 0!==e&&e<this.maxInputs?this.inputs[e]=new Connection(this,t):this.inputs.length<this.maxInputs&&this.inputs.push(new Connection(this,t))}},{key:"update",value:function(){for(var t=[],e=0;e<this.maxInputs;e++)t[e]=void 0!==this.inputs[e]&&this.inputs[e].getValue();var n=this.activation(t);n===this.prevOutput&&(this.output=n)}},{key:"tickEnd",value:function(){for(var t=[],e=0;e<this.maxInputs;e++)t[e]=void 0!==this.inputs[e]&&this.inputs[e].getValue();this.prevOutput=this.activation(t)}},{key:"getGateForOutput",value:function(t){return this}},{key:"serializeParameters",value:function(){return""}},{key:"parseParameters",value:function(t){}},{key:"onClick",value:function(){}},{key:"createSave",value:function(){return{x:this.x,y:this.y,output:this.output,type:this.type,id:this.id}}},{key:"setGraphicProperties",value:function(t,e,n,r,o,i){return this.x=t,this.y=e,this.width=n*Interface.zoomFactor,this.height=r*Interface.zoomFactor,this.color=o,i&&(this.name=i),this.fontSize*=Interface.zoomFactor,this}},{key:"setPosition",value:function(t,e){return this.x=t,this.y=e,this}},{key:"draw",value:function(){this.drawBody(),this.hideName||(ctx.fillStyle="#ffffff",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=this.fontSize+"px Arial",ctx.fillText(this.name,this.x,this.y))}},{key:"drawBody",value:function(){ctx.fillStyle=this.color,ctx.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),ctx.strokeStyle="#000000",ctx.lineWidth=1,ctx.strokeRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height)}},{key:"getInputPosition",value:function(t){return[this.x-this.width/2+Interface.connectionWidth,this.y-this.height/2+this.height*(t+1)/(this.maxInputs+1)]}},{key:"getOutputPosition",value:function(){return[this.x+this.width/2-Interface.connectionWidth,this.y]}}],[{key:"updateAll",value:function(t){var e,n=_createForOfIteratorHelper(t);try{for(n.s();!(e=n.n()).done;){e.value.update()}}catch(t){n.e(t)}finally{n.f()}var r,o=_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){r.value.tickEnd()}}catch(t){o.e(t)}finally{o.f()}}},{key:"removeAllConnectionsTo",value:function(t,e){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;)for(var o=n.value,i=0;i<o.inputs.length;i++)void 0!==o.inputs[i]&&o.inputs[i].destination===t&&(o.inputs[i]=void 0)}catch(t){r.e(t)}finally{r.f()}}},{key:"drawAll",value:function(t){var e,n=_createForOfIteratorHelper(t);try{for(n.s();!(e=n.n()).done;)for(var r=e.value,o=0;o<r.maxInputs;o++)r.inputs[o]&&r.inputs[o].draw(o)}catch(t){n.e(t)}finally{n.f()}var i,a=_createForOfIteratorHelper(t);try{for(a.s();!(i=a.n()).done;){i.value.draw()}}catch(t){a.e(t)}finally{a.f()}}}]),t}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}_defineProperty(Gate,"nextID",0);var GateFactory=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"UP",value:function(t,e){return(new Gate).setFonctionnalProperties("UP",function(){return!0},[]).setGraphicProperties(t,e,40,40,"#ffbf00")}},{key:"DOWN",value:function(t,e){return(new Gate).setFonctionnalProperties("DOWN",function(){return!1},[]).setGraphicProperties(t,e,40,40,"#5f5f5f")}},{key:"NOT",value:function(t,e,n){var r=(new Gate).setFonctionnalProperties("NOT",function(t){return!t[0]},n,1).setGraphicProperties(t,e,30,20,"#379f1f");return r.drawBody=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/2,this.y-this.height/2),ctx.lineTo(this.x+this.width/2-2*Interface.negCircleR,this.y),ctx.lineTo(this.x-this.width/2,this.y+this.height/2),ctx.lineTo(this.x-this.width/2,this.y-this.height/2),ctx.fillStyle=this.color,ctx.fill(),ctx.lineWidth=1,ctx.strokeStyle="#000000",ctx.stroke(),Tools.fillCircle(this.x+this.width/2-Interface.negCircleR,this.y,Interface.negCircleR)},r.hideName=!0,r}},{key:"AND",value:function(t,e,n){var r=(new Gate).setFonctionnalProperties("AND",function(t){return t[0]&&t[1]},n,2).setGraphicProperties(t,e,40,40,"#379f1f");return r.drawBody=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/2,this.y-this.height/2),ctx.lineTo(this.x+this.width/2-this.height/2,this.y-this.height/2),ctx.arc(this.x+this.width/2-this.height/2,this.y,this.height/2,-Math.PI/2,Math.PI/2),ctx.lineTo(this.x-this.width/2,this.y+this.height/2),ctx.lineTo(this.x-this.width/2,this.y-this.height/2),ctx.fillStyle=this.color,ctx.fill(),ctx.lineWidth=1,ctx.strokeStyle="#000000",ctx.stroke()},r.hideName=!0,r}},{key:"OR",value:function(t,e,n){var r=(new Gate).setFonctionnalProperties("OR",function(t){return t[0]||t[1]},n,2).setGraphicProperties(t,e,40,40,"#379f1f");return r.drawBody=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/2,this.y+this.height/2),ctx.quadraticCurveTo(this.x-this.width/4,this.y,this.x-this.width/2,this.y-this.height/2),ctx.quadraticCurveTo(this.x+this.width/4,this.y-this.height/2,this.x+this.width/2,this.y),ctx.moveTo(this.x-this.width/2,this.y+this.height/2),ctx.quadraticCurveTo(this.x+this.width/4,this.y+this.height/2,this.x+this.width/2,this.y),ctx.fillStyle=this.color,ctx.fill(),ctx.lineWidth=1,ctx.strokeStyle="#000000",ctx.stroke()},r.hideName=!0,r}},{key:"XOR",value:function(t,e,n){var r=(new Gate).setFonctionnalProperties("XOR",function(t){return t[0]!==t[1]},n,2).setGraphicProperties(t,e,45,40,"#379f1f");return r.drawBody=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/2+this.width/8,this.y+this.height/2),ctx.quadraticCurveTo(this.x-this.width/4+this.width/8,this.y,this.x-this.width/2+this.width/8,this.y-this.height/2),ctx.quadraticCurveTo(this.x+this.width/4,this.y-this.height/2,this.x+this.width/2,this.y),ctx.moveTo(this.x-this.width/2+this.width/8,this.y+this.height/2),ctx.quadraticCurveTo(this.x+this.width/4,this.y+this.height/2,this.x+this.width/2,this.y),ctx.fillStyle=this.color,ctx.fill(),ctx.lineWidth=1,ctx.strokeStyle="#000000",ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.x-this.width/2,this.y+this.height/2),ctx.quadraticCurveTo(this.x-this.width/4,this.y,this.x-this.width/2,this.y-this.height/2),ctx.lineWidth=3,ctx.strokeStyle="#000000",ctx.stroke()},r.hideName=!0,r}},{key:"NAND",value:function(t,e,n){var r=(new Gate).setFonctionnalProperties("NAND",function(t){return!(t[0]&&t[1])},n,2).setGraphicProperties(t,e,50,40,"#379f1f");return r.drawBody=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/2,this.y-this.height/2),ctx.lineTo(this.x+this.width/2-this.height/2-2*Interface.negCircleR,this.y-this.height/2),ctx.arc(this.x+this.width/2-this.height/2-2*Interface.negCircleR,this.y,this.height/2,-Math.PI/2,Math.PI/2),ctx.lineTo(this.x-this.width/2,this.y+this.height/2),ctx.lineTo(this.x-this.width/2,this.y-this.height/2),ctx.fillStyle=this.color,ctx.fill(),ctx.lineWidth=1,ctx.strokeStyle="#000000",ctx.stroke(),Tools.fillCircle(this.x+this.width/2-Interface.negCircleR,this.y,Interface.negCircleR)},r.hideName=!0,r}},{key:"NOR",value:function(t,e,n){var r=(new Gate).setFonctionnalProperties("NOR",function(t){return!(t[0]||t[1])},n,2).setGraphicProperties(t,e,50,40,"#379f1f");return r.drawBody=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/2,this.y+this.height/2),ctx.quadraticCurveTo(this.x-this.width/4,this.y,this.x-this.width/2,this.y-this.height/2),ctx.quadraticCurveTo(this.x+this.width/4-2*Interface.negCircleR,this.y-this.height/2,this.x+this.width/2-2*Interface.negCircleR,this.y),ctx.moveTo(this.x-this.width/2,this.y+this.height/2),ctx.quadraticCurveTo(this.x+this.width/4-2*Interface.negCircleR,this.y+this.height/2,this.x+this.width/2-2*Interface.negCircleR,this.y),ctx.fillStyle=this.color,ctx.fill(),ctx.lineWidth=1,ctx.strokeStyle="#000000",ctx.stroke(),Tools.fillCircle(this.x+this.width/2-Interface.negCircleR,this.y,Interface.negCircleR)},r.hideName=!0,r}},{key:"XNOR",value:function(t,e,n){var r=(new Gate).setFonctionnalProperties("XNOR",function(t){return t[0]===t[1]},n,2).setGraphicProperties(t,e,55,40,"#379f1f");return r.drawBody=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/2+this.width/8,this.y+this.height/2),ctx.quadraticCurveTo(this.x-this.width/4+this.width/8,this.y,this.x-this.width/2+this.width/8,this.y-this.height/2),ctx.quadraticCurveTo(this.x+this.width/4-2*Interface.negCircleR,this.y-this.height/2,this.x+this.width/2-2*Interface.negCircleR,this.y),ctx.moveTo(this.x-this.width/2+this.width/8,this.y+this.height/2),ctx.quadraticCurveTo(this.x+this.width/4-2*Interface.negCircleR,this.y+this.height/2,this.x+this.width/2-2*Interface.negCircleR,this.y),ctx.fillStyle=this.color,ctx.fill(),ctx.lineWidth=1,ctx.strokeStyle="#000000",ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.x-this.width/2,this.y+this.height/2),ctx.quadraticCurveTo(this.x-this.width/4,this.y,this.x-this.width/2,this.y-this.height/2),ctx.lineWidth=3,ctx.strokeStyle="#000000",ctx.stroke(),Tools.fillCircle(this.x+this.width/2-Interface.negCircleR,this.y,Interface.negCircleR)},r.hideName=!0,r}},{key:"INPUT",value:function(t,e){return(new Input).setFonctionnalProperties("INPUT").setGraphicProperties(t,e,40,40,"#db7ed2")}},{key:"CLOCK",value:function(t,e,n){return(new Clock).setPeriod(n).setFonctionnalProperties("CLOCK").setGraphicProperties(t,e,40,40,"#3d79e7")}},{key:"OUTPUT",value:function(t,e,n){return(new Output).setFonctionnalProperties("OUTPUT",function(t){return t[0]},n,1).setGraphicProperties(t,e,40,40,"#7a7a7a").setHideName(!0)}},{key:"NODE",value:function(t,e,n){return(new ConnectionNode).setFonctionnalProperties("NODE",function(t){return t[0]},n,1).setGraphicProperties(t,e,10,7,"#7a7a7a").setHideName(!0)}},{key:"SWITCH",value:function(t,e,n){return(new Switch).setFonctionnalProperties("SWITCH",function(t){return t[0]},n,1).setGraphicProperties(t,e,45,20,"#ff5d2d")}}]),t}(),gatesLibrary=[{name:"AND 3",code:"AND3;A&B&C;O$4;AND$0$1&AND$3$2"},{name:"OR 3",code:"OR3;A&B&C;O$4;OR$0$1&OR$3$2"},{name:"NAND 3",code:"NAND3;A&B&C;O$4;AND$0$1&NAND$3$2"},{name:"NOR 3",code:"NOR3;A&B&C;O$4;OR$0$1&NOR$3$2"},{name:"AND 4",code:"AND4;A&B&C&D;O$5;AND$0$1&AND$4$6&AND$2$3"},{name:"OR 4",code:"OR4;A&B&C&D;O$5;OR$0$1&OR$4$6&OR$2$3"},{name:"NAND 4",code:"NAND4;A&B&C&D;O$5;AND$0$1&NAND$4$6&AND$2$3"},{name:"NOR 4",code:"NOR4;A&B&C&D;O$5;OR$0$1&NOR$4$6&OR$2$3"},{name:"1b Memory",code:"1b MEM;DataIN&WriteEN;DataOUT$2;NOR$5$3&NOR$2$6&NOT$0&AND$4$1&AND$0$1"},{name:"1 Byte Memory",code:"1B MEM;I0&I1&I2&I3&I4&I5&I6&I7&WE&CS;O0$50&O1$51&O2$52&O3$53&O4$54&O5$55&O6$56&O7$57;NOR$13$11&NOR$10$14&NOT$0&AND$12$8&AND$0$8&NOR$18$16&NOR$15$19&NOT$2&AND$17$8&AND$2$8&NOR$23$21&NOR$20$24&NOT$3&AND$22$8&AND$3$8&NOR$28$26&NOR$25$29&NOT$4&AND$27$8&AND$4$8&NOR$33$31&NOR$30$34&NOT$5&AND$32$8&AND$5$8&NOR$38$36&NOR$35$39&NOT$6&AND$37$8&AND$6$8&NOR$43$41&NOR$40$44&NOT$1&AND$42$8&AND$1$8&NOR$48$46&NOR$45$49&NOT$7&AND$47$8&AND$7$8&AND$10$9&AND$40$9&AND$15$9&AND$20$9&AND$25$9&AND$30$9&AND$35$9&AND$45$9"},{name:"7 segments decoder",code:"7 SEG;Q0&Q1&Q2&Q3;T$19&TR$28&BR$35&B$45&BL$49&TL$55&M$61;AND$3$36&AND$4$39&AND$0$2&AND$6$40&AND$0$1&AND$8$39&AND$34$39&AND$10$40&AND$2$36&AND$12$40&AND$2$36&AND$14$40&OR$7$17&AND$1$18&OR$2$40&OR$16$22&OR$3$39&AND$20$34&OR$21$5&XNOR$0$1&AND$23$40&AND$0$3&OR$24$27&AND$25$36&OR$26$30&OR$34$40&AND$29$39&XOR$2$3&OR$31$33&AND$0$40&NOT$0&OR$32$37&NOT$1&AND$36$38&OR$0$40&NOT$2&NOT$3&XOR$0$1&AND$41$2&AND$3$36&OR$42$9&OR$44$46&OR$43$11&OR$1$2&AND$47$3&OR$48$50&AND$34$51&OR$1$39&OR$1$39&AND$52$3&OR$53$13&OR$54$57&OR$2$36&AND$56$34&OR$0$39&AND$58$3&OR$59$15&OR$60$62&AND$1$63&OR$34$39"},{name:"Merge",code:"MERGE;A0&A1&A2&A3&A4&A5&A6&A7&B0&B1&B2&B3&B4&B5&B6&B7;O0$16&O1$17&O2$18&O3$19&O4$20&O5$21&O6$22&O7$23;OR$0$8&OR$1$9&OR$2$10&OR$3$11&OR$4$12&OR$5$13&OR$6$14&OR$7$15"},{name:"Adder",code:"ADD;A&B&Cin;R$4&Cout$6;XOR$0$1&XOR$3$2&AND$0$1&OR$5$7&AND$3$2"},{name:"SR latch",code:"SR;R&S;Q$2&/Q$3;NOR$0$3&NOR$2$1"},{name:"JK flip flop",code:"JK;/PRE&J&CLK&K&/CLE;Q$6&/Q$8;AND$0$10&NAND$5$8&AND$6$13&NAND$7$4&AND$4$1&NAND$9$11&AND$2$8&AND$6$2&NAND$12$14&AND$3$0"},{name:"JK (Synchronised on rising edges)",code:"JK RIS;/PRE&J&CLK&K&/CLE;Q$10&/Q$12;AND$2$8&NOT$2&NOT$6&NOT$7&AND$0$14&NAND$9$12&AND$10$17&NAND$11$4&AND$4$1&NAND$13$15&AND$5$12&AND$10$5&NAND$16$18&AND$3$0"},{name:"JK Master-Slave",code:"JK MSTSLV;/PRE&J&CLK&K&/CLE;Q$24&/Q$26;AND$2$8&NOT$2&NOT$6&NOT$7&AND$0$14&NAND$9$12&AND$10$17&NAND$11$4&AND$4$1&NAND$13$15&AND$5$12&AND$10$5&NAND$16$18&AND$3$0&AND$33$22&NOT$33&NOT$20&NOT$21&AND$0$28&NAND$23$26&AND$24$31&NAND$25$4&AND$4$10&NAND$27$29&AND$19$26&AND$24$19&NAND$30$32&AND$12$0&NOT$2"},{name:"D latch",code:"D;D&E;Q$2&/Q$3;NOR$4$3&NOR$2$6&AND$1$5&NOT$0&AND$1$0"},{name:"D  (Synchronised on rising edges)",code:"D RIS;D&CLK;Q$2&/Q$3;NOR$4$3&NOR$2$6&AND$7$5&NOT$0&AND$7$0&AND$1$10&NOT$1&NOT$8&NOT$9"},{name:"Multiplexer",code:"MUX;A&B&S;O$5;AND$0$4&NOT$2&OR$3$6&AND$1$2"},{name:"Multiplexer 4",code:"MUX4;A&B&C&D&S0&S1;O$16;AND$0$7&NOT$4&OR$6$9&AND$1$4&AND$2$11&NOT$4&OR$10$13&AND$3$4&AND$8$15&NOT$5&OR$14$17&AND$12$5"},{name:"Multiplexer 8",code:"MUX8;A&B&C&D&E&F&G&H&S0&S1&S2;O$25;AND$0$12&NOT$8&OR$11$14&AND$1$8&AND$2$16&NOT$8&OR$15$18&AND$3$8&AND$13$20&NOT$9&OR$19$22&AND$17$9&AND$21$24&NOT$10&OR$23$26&AND$37$10&AND$4$28&NOT$8&OR$27$30&AND$5$8&AND$6$32&NOT$8&OR$31$34&AND$7$8&AND$29$36&NOT$9&OR$35$38&AND$33$9"},{name:"Demultiplexer",code:"DEMUX;I&S;A$2&B$4;AND$0$3&NOT$1&AND$0$1"},{name:"Demultiplexer 4",code:"DEMUX4;I&S0&S1;A$6&B$8&C$9&D$11;AND$0$4&NOT$2&AND$0$2&AND$3$7&NOT$1&AND$3$1&AND$5$10&NOT$1&AND$5$1"},{name:"Demultiplexer 8",code:"DEMUX8;I&S0&S1&S2;A$7&B$9&C$10&D$12&E$16&F$18&G$19&H$21;AND$22$5&NOT$2&AND$22$2&AND$4$8&NOT$1&AND$4$1&AND$6$11&NOT$1&AND$6$1&AND$24$14&NOT$2&AND$24$2&AND$13$17&NOT$1&AND$13$1&AND$15$20&NOT$1&AND$15$1&AND$0$23&NOT$3&AND$0$3"},{name:"Rising edge detector",code:"RIS EDGE;I;O$1;AND$0$4&NOT$0&NOT$2&NOT$3"},{name:"Falling edge detector",code:"FAL EDGE;I;O$1;NOR$0$4&NOT$3&NOT$0&NOT$2"},{name:"Delay 20",code:"DELAY20;I;O$20;NOT$0&NOT$1&NOT$2&NOT$3&NOT$4&NOT$5&NOT$6&NOT$7&NOT$8&NOT$9&NOT$10&NOT$11&NOT$12&NOT$13&NOT$14&NOT$15&NOT$16&NOT$17&NOT$18&NOT$19"}];function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var SerializerParser=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"parseCustomGate",value:function(t){try{var e=function(t,e){for(var r=1;r<e.length;r++)""!==e[r]&&(t.inputs[r-1]=new Connection(t,e[r]<n.maxInputs?n.inputGates[e[r]]:n.internGates[e[r]-n.maxInputs]))},n=new CustomGate;n.type="CUSTOM",n.string=t;for(var r=t.split(";"),o=r[1].split("&").filter(function(t){return""!==t}),i=0;i<o.length;i++){var a=new Gate;a.name=o[i],n.inputGates[i]=a}n.maxInputs=o.length;for(var s=r[2].split("&").filter(function(t){return""!==t}),u=0;u<s.length;u++){var c=s[u].split("$"),l=GateFactory.NODE(0,0);l.name=c[0],l.width=0,n.outputGates[u]=l}for(var f=r[3].split("&").filter(function(t){return""!==t}),h=0;h<f.length;h++){var p=f[h].split("$")[0].split("@"),d=GateFactory[p[0]];n.internGates[h]=d(0,0),n.internGates[h].parseParameters(p)}for(var y=0;y<s.length;y++){var v=s[y].split("$").filter(function(t){return""!==t});e(n.outputGates[y],v)}for(var $=0;$<f.length;$++){var g=f[$].split("$").filter(function(t){return""!==t});e(n.internGates[$],g)}return n.maxOutputs=n.outputGates.length,n.setGraphicProperties(mouseX,mouseY,100,20+20*Math.max(n.maxInputs,n.maxOutputs),"#379f1f",r[0])}catch(e){return console.log((new Date).toJSON()+"\nError while parsing gate data\n"+t+"\n"+e.stack),Popup.close(),void Popup.openError("An error occured while parsing gate data:\n"+t)}}},{key:"serializeCustomGate",value:function(t,e,n){SimulatorState.export(t);var r="";function o(t){var e,n=_createForOfIteratorHelper(t.internGates.concat(t.outputGates));try{for(n.s();!(e=n.n()).done;){for(var r=e.value,o=0;o<r.maxInputs;o++)if(void 0!==r.inputs[o]&&null!==r.inputs[o]){var i=t.inputGates.indexOf(r.inputs[o].destination);-1!==i&&(t.inputs[i]?r.inputs[o].destination=t.inputs[i].destination:r.inputs.splice(o,1))}gates.push(r)}}catch(t){n.e(t)}finally{n.f()}}function i(t,e){r[r.length-1]===t?r=r.substring(0,r.length-1)+e:r+=e}function a(t){for(var n=t instanceof Input,r=n?0:e.length,o=0;o<gates.length;o++){if(gates[o]===t)return r;n?gates[o]instanceof Input&&r++:gates[o]instanceof Output||gates[o]instanceof Input||r++}return-1}for(var s=0;s<gates.length;s++)gates[s]instanceof CustomGate&&o(gates[s]);var u,c=_createForOfIteratorHelper(gates);try{for(c.s();!(u=c.n()).done;)for(var l=u.value,f=0;f<l.maxInputs;f++)l.inputs[f]&&(l.inputs[f].destination=l.inputs[f].getInput())}catch(t){c.e(t)}finally{c.f()}gates=(gates=gates.filter(function(t){return!(t instanceof ConnectionNode)})).filter(function(t){return!(t instanceof CustomGate)}).sort(function(t,e){return t.y-e.y}),r=t+";";var h,p=_createForOfIteratorHelper(e);try{for(p.s();!(h=p.n()).done;){var d=h.value;r+=d+"&"}}catch(t){p.e(t)}finally{p.f()}i("&",";");var y,v=0,$=_createForOfIteratorHelper(gates);try{for($.s();!(y=$.n()).done;){var g=y.value;if(g instanceof Output){r+=n[v]+"$";var O,m=_createForOfIteratorHelper(g.inputs);try{for(m.s();!(O=m.n()).done;){var b=O.value;r+=(b?a(b.destination):"NULL")+"$"}}catch(t){m.e(t)}finally{m.f()}v++,i("$","&")}}}catch(t){$.e(t)}finally{$.f()}i("&",";");var _,P=_createForOfIteratorHelper(gates);try{for(P.s();!(_=P.n()).done;){var w=_.value;if(!(w instanceof Output||w instanceof Input)){r+=w.type+w.serializeParameters()+"$";var N,C=_createForOfIteratorHelper(w.inputs);try{for(C.s();!(N=C.n()).done;){var x=N.value;r+=(x?a(x.destination):"NULL")+"$"}}catch(t){C.e(t)}finally{C.f()}v++,i("$","&")}}}catch(t){P.e(t)}finally{P.f()}return i("&",""),gates=[],r}}]),t}();function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var SimulatorState=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"export",value:function(t){var e,n={gates:[],interfaceZoomFactor:Interface.zoomFactor,origin:Interface.origin},r=_createForOfIteratorHelper(gates);try{for(r.s();!(e=r.n()).done;){var o=e.value,i=o.createSave();i.inputs=o.inputs.map(function(t){if(null==t)return null;var e=t.destination;if(e instanceof ConnectionNode){var n=e.findParentCustomGate();if(null!==n)return[n.gate.id,n.outputIndex]}return[e.id]}),n.gates.push(i)}}catch(t){r.e(t)}finally{r.f()}Tools.download(JSON.stringify(n),(t||"LogicGateSimulator")+".lgs")}},{key:"askForImport",value:function(){var e=window.document.createElement("INPUT");e.accept=".lgs",e.type="file",e.click(),e.addEventListener("change",function(){e.files[0]&&e.files[0].text().then(t.import)})}},{key:"import",value:function(t){try{var e=function(t,e){var n=o.find(function(e){return e.id===t});return void 0===e?n:n.outputGates[e]},n=JSON.parse(t);if(0===n.gates.length)return;var r=Gate.nextID,o=n.gates.map(function(t){var e;if("CUSTOM"===t.type){if(!(e=SerializerParser.parseCustomGate(t.string)))return}else e=(0,GateFactory[t.type])(0,0);return Object.assign(e,t),e.id+=r,e.x*=Interface.zoomFactor/n.interfaceZoomFactor,e.y*=Interface.zoomFactor/n.interfaceZoomFactor,e}),i=o.reduce(function(t,e){return t+e.x},0)/o.length,a=o.reduce(function(t,e){return t+e.y},0)/o.length;if(n.origin){n.origin[0]*=Interface.zoomFactor/n.interfaceZoomFactor,n.origin[1]*=Interface.zoomFactor/n.interfaceZoomFactor,n.origin[0]+=canvas.width/2-i,n.origin[1]+=canvas.height/2-a;var s=Interface.getSnappedPosition(n.origin[0],n.origin[1]);i-=s[0]-n.origin[0],a-=s[1]-n.origin[1]}var u,c=_createForOfIteratorHelper(o);try{for(c.s();!(u=c.n()).done;){var l=u.value;l.x+=canvas.width/2-i,l.y+=canvas.height/2-a}}catch(t){c.e(t)}finally{c.f()}var f,h=_createForOfIteratorHelper(o);try{for(h.s();!(f=h.n()).done;){var p=f.value,d=p.inputs;p.inputs=[];for(var y=0;y<d.length;y++)if(null!==d[y]){var v=e(d[y][0]+r,d[y][1]);p.inputs[y]=new Connection(p,v)}}}catch(t){h.e(t)}finally{h.f()}gates=gates.concat(o);var $,g=_createForOfIteratorHelper(gates);try{for(g.s();!($=g.n()).done;){var O=$.value;Gate.nextID=Math.max(Gate.nextID,O.id)}}catch(t){g.e(t)}finally{g.f()}Gate.nextID++}catch(t){console.log((new Date).toJSON()+"\nError while parsing save data\n"+t.stack),Popup.close(),Popup.openError("An error occured while parsing save data")}}}]),t}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Clock=function(t){_inherits(n,Gate);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).period=50,t.current=0,t}return _createClass(n,[{key:"update",value:function(){this.current--,this.current<0&&(this.current=this.period,this.output=!this.output)}},{key:"onClick",value:function(){Popup.open(),Popup.addTitle("Clock configuration"),Popup.addSpace(),Popup.addText("Period is the time in milliseconds between 2 state changes (rise or fall of the signal). Current is the time in milliseconds before the next state change (can be used to synchronise clocks during a pause).\nThese two values are accurate only if your computer can calculate one update is less than a millisecond. Otherwise then can be longer (but the clock will always wait for the given amount of updates)."),Popup.addFields([{id:"clockPeriod",defaultValue:this.period}],"Period:"),Popup.addFields([{id:"clockCurrent",defaultValue:this.current}],"Current:"),Popup.addDoneButton(n.chooseParameters),n.openedPopup=this}},{key:"setPeriod",value:function(t,e){return this.period=t,e&&(this.current=e),this}},{key:"serializeParameters",value:function(){return"@".concat(this.period,"@").concat(this.current)}},{key:"parseParameters",value:function(t){this.period=t[1],this.current=t[2]}},{key:"createSave",value:function(){var t=_get(_getPrototypeOf(n.prototype),"createSave",this).call(this);return t.period=this.period,t.current=this.current,t}}],[{key:"chooseParameters",value:function(){var t=document.getElementById("clockPeriod").value;isNaN(t)||(n.openedPopup.period=t);var e=document.getElementById("clockCurrent").value;isNaN(e)||(n.openedPopup.current=e),Popup.close()}}]),n}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}_defineProperty(Clock,"openedPopup",void 0);var ConnectionNode=function(t){_inherits(n,Gate);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).upColor="#ffbf00",t.downColor="#7a7a7a",t}return _createClass(n,[{key:"tickEnd",value:function(){_get(_getPrototypeOf(n.prototype),"tickEnd",this).call(this),this.color=this.output?this.upColor:this.downColor}},{key:"findParentCustomGate",value:function(){var t,e=_createForOfIteratorHelper(gates);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(n instanceof CustomGate)for(var r=0;r<n.outputGates.length;r++)if(n.outputGates[r]===this)return{gate:n,outputIndex:r}}}catch(t){e.e(t)}finally{e.f()}return null}}]),n}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var CustomGate=function(t){_inherits(n,Gate);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).internGates=[],t.inputGates=[],t.outputGates=[],t.string="",t}return _createClass(n,[{key:"update",value:function(){for(var t=0;t<this.inputGates.length;t++)this.inputGates[t].output=void 0!==this.inputs[t]&&this.inputs[t].getValue();var e,n=_createForOfIteratorHelper(this.internGates);try{for(n.s();!(e=n.n()).done;){e.value.update()}}catch(t){n.e(t)}finally{n.f()}}},{key:"tickEnd",value:function(){var t,e=_createForOfIteratorHelper(this.internGates);try{for(e.s();!(t=e.n()).done;){t.value.tickEnd()}}catch(t){e.e(t)}finally{e.f()}}},{key:"getGateForOutput",value:function(t){return this.outputGates[t]}},{key:"onClick",value:function(){Popup.open(),Popup.addTitle("Custom Gate Information"),Popup.addSpace(),Popup.addText(this.string),Popup.addDoneButton(Popup.close)}},{key:"createSave",value:function(){var t=_get(_getPrototypeOf(n.prototype),"createSave",this).call(this);return t.string=this.string,t.maxInputs=this.maxInputs,t}},{key:"draw",value:function(){for(var t=0;t<this.outputGates.length;t++){var e=this.getOutputPosition(t);this.outputGates[t].x=e[0],this.outputGates[t].y=e[1]}_get(_getPrototypeOf(n.prototype),"draw",this).call(this),ctx.fillStyle="#ffffff",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=.8*this.fontSize+"px Arial";for(var r=0;r<this.outputGates.length;r++){var o=this.getOutputPosition(r);ctx.fillText(this.outputGates[r].name,o[0]-this.width/10,o[1])}for(var i=0;i<this.inputGates.length;i++){var a=this.getInputPosition(i);ctx.fillText(this.inputGates[i].name,a[0]+this.width/10,a[1])}}},{key:"getOutputPosition",value:function(t){return[this.x+this.width/2-Interface.connectionWidth,this.y-this.height/2+this.height*(t+1)/(this.maxOutputs+1)]}}],[{key:"openPopup",value:function(){Popup.open();var t,e=0,n=0,r=_createForOfIteratorHelper(gates);try{for(r.s();!(t=r.n()).done;){var o=t.value;o instanceof Input&&e++,o instanceof Output&&n++}}catch(t){r.e(t)}finally{r.f()}Popup.addTitle("Custom Gate Configuration"),Popup.addSpace(),Popup.addFields([{id:"name"}],"Gate name"),Popup.addSpace();for(var i=[],a=0;a<e;a++)i.push({id:"input"+a});Popup.addText("Input names: "),i.length>0&&Popup.addFields(i," "),Popup.addSpace();for(var s=[],u=0;u<n;u++)s.push({id:"output"+u});Popup.addText("Output names: "),i.length>0&&Popup.addFields(s," "),Popup.addSpace(),Popup.addDoneButton(function(){for(var t=[],r=0;r<e;r++)t[r]=document.getElementById("input"+r).value;for(var o=[],i=0;i<n;i++)o[i]=document.getElementById("output"+i).value;var a=SerializerParser.parseCustomGate(SerializerParser.serializeCustomGate(document.getElementById("name").value,t,o));BuildMode.addGate(a,!1),Popup.close(),a.onClick(),BuildMode.lastCustomGate=a.string})}}]),n}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Input=function(t){_inherits(n,Gate);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).upColor="#ffbf00",t.downColor="#7a7a7a",t.isOn=!0,t}return _createClass(n,[{key:"update",value:function(){this.output=this.isOn}},{key:"onClick",value:function(){this.isOn=!this.isOn}},{key:"createSave",value:function(){var t=_get(_getPrototypeOf(n.prototype),"createSave",this).call(this);return t.isOn=this.isOn,t}},{key:"drawBody",value:function(){_get(_getPrototypeOf(n.prototype),"drawBody",this).call(this),ctx.fillStyle=this.isOn?this.upColor:this.downColor,ctx.fillRect(this.x-this.width/2+this.width/8,this.y-this.height/2+this.height/8,this.width-2*this.width/8,this.height-2*this.height/8)}}]),n}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Output=function(t){_inherits(n,Gate);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).upColor="#ffbf00",t.downColor="#7a7a7a",t.maxOutputs=0,t}return _createClass(n,[{key:"tickEnd",value:function(){_get(_getPrototypeOf(n.prototype),"tickEnd",this).call(this),this.color=this.output?this.upColor:this.downColor}}]),n}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Switch=function(t){_inherits(n,Gate);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).isOn=!0,t}return _createClass(n,[{key:"update",value:function(){this.isOn?_get(_getPrototypeOf(n.prototype),"update",this).call(this):this.output=!1}},{key:"onClick",value:function(){this.isOn=!this.isOn}},{key:"serializeParameters",value:function(){return"@"+(this.isOn?"1":"0")}},{key:"parseParameters",value:function(t){this.isOn="1"===t[1]}},{key:"createSave",value:function(){var t=_get(_getPrototypeOf(n.prototype),"createSave",this).call(this);return t.isOn=this.isOn,t}},{key:"drawBody",value:function(){_get(_getPrototypeOf(n.prototype),"drawBody",this).call(this),this.isOn||(ctx.fillStyle=Interface.BACKGROUND_COLOR,ctx.fillRect(this.x-this.width/2+this.width/5,this.y-this.height/2,this.width-2*this.width/5,this.height))}}]),n}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var Button=function(){function t(){_classCallCheck(this,t),this.x=0,this.y=0,this.width=80,this.height=50,this.name="",this.color="#000000",this.fontSize=14}return _createClass(t,[{key:"setOnClick",value:function(t){return this.onClick=t,this}},{key:"onClick",value:function(){}},{key:"setGraphicProperties",value:function(t,e,n,r){return this.width=t,this.height=e,this.name=n,this.color=r,this}},{key:"draw",value:function(){ctx.fillStyle=this.color,ctx.fillRect(this.x-this.width/2,this.y-this.height/2,this.width,this.height),ctx.fillStyle=Interface.BACKGROUND_COLOR,ctx.fillRect(this.x-this.width/2+this.width/15,this.y-this.height/2+this.height/15,this.width-2*this.width/15,this.height-2*this.height/15),this.drawCenter()}},{key:"drawCenter",value:function(){this.drawName()}},{key:"drawName",value:function(){ctx.fillStyle="#ffffff",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=this.fontSize+"px Arial",ctx.fillText(this.name,this.x,this.y)}}]),t}();function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Interface=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"clear",value:function(){ctx.fillStyle=t.BACKGROUND_COLOR,ctx.fillRect(0,0,canvas.width,canvas.height)}},{key:"draw",value:function(){t.getCurrentMode().lateUpdate(),t.buttons[0].color=0===t.mode?"#ffeb47":"#ffffff",t.buttons[1].color=1===t.mode?"#ffeb47":"#ffffff",t.buttons[2].color=2===t.mode?"#ffeb47":"#ffffff",t.buttons[0].x=canvas.width/2-t.buttons[0].width-t.BUTTON_SPACING,t.buttons[0].y=t.buttons[0].height/2+t.BUTTON_SPACING,t.buttons[1].x=canvas.width/2,t.buttons[1].y=t.buttons[0].height/2+t.BUTTON_SPACING,t.buttons[2].x=canvas.width/2+t.buttons[0].width+t.BUTTON_SPACING,t.buttons[2].y=t.buttons[0].height/2+t.BUTTON_SPACING,t.buttons[0].draw(),t.buttons[1].draw(),t.buttons[2].draw(),t.buttons[3].x=.5*t.buttons[3].width+t.BUTTON_SPACING,t.buttons[3].y=.5*t.buttons[3].height+t.BUTTON_SPACING,t.buttons[4].x=1.5*t.buttons[3].width+2*t.BUTTON_SPACING,t.buttons[4].y=.5*t.buttons[3].height+t.BUTTON_SPACING,t.buttons[3].draw(),t.buttons[4].draw(),t.buttons[5].x=.5*t.buttons[5].width+t.BUTTON_SPACING,t.buttons[5].y=.5*t.buttons[5].height+t.buttons[3].height+2*t.BUTTON_SPACING,t.buttons[5].draw(),0===framesToCalculate?(t.buttons[6].x=1.5*t.buttons[6].width+2*t.BUTTON_SPACING,t.buttons[6].y=.5*t.buttons[6].height+t.buttons[4].height+2*t.BUTTON_SPACING,t.buttons[6].draw()):(t.buttons[6].x=-1e3,t.buttons[6].y=-1e3)}},{key:"getButtonAtPosition",value:function(e,n){var r,o=_createForOfIteratorHelper(t.getCurrentMode().buttons.concat(t.buttons));try{for(o.s();!(r=o.n()).done;){var i=r.value;if(Math.abs(e-i.x)<i.width/2&&Math.abs(n-i.y)<i.height/2)return i}}catch(t){o.e(t)}finally{o.f()}return null}},{key:"init",value:function(){t.origin=[0,0],t.zoomFactor=1,t.mode=0,t.blockInputs=!1,t.negCircleR=5,t.connectionGap=20,t.connectionWidth=3,BuildMode.init(),WiringMode.init(),InteractionMode.init(),t.buttons=[(new Button).setGraphicProperties(90,30,"Build","#ffffff").setOnClick(function(){return BuildMode.enable()}),(new Button).setGraphicProperties(90,30,"Wiring","#ffffff").setOnClick(function(){return WiringMode.enable()}),(new Button).setGraphicProperties(90,30,"Interaction","#ffffff").setOnClick(function(){return InteractionMode.enable()}),(new Button).setGraphicProperties(70,40,"Import","#00e1ff").setOnClick(function(){return SimulatorState.askForImport()}),(new Button).setGraphicProperties(70,40,"Export","#00e1ff").setOnClick(function(){return SimulatorState.export()}),(new Button).setGraphicProperties(30,30,"","#ff9100").setOnClick(function(){return framesToCalculate=-!framesToCalculate}),(new Button).setGraphicProperties(30,30,"","#ff9100").setOnClick(function(){framesToCalculate>=0&&framesToCalculate++})],t.buttons[5].drawCenter=function(){ctx.beginPath(),0===framesToCalculate?(ctx.moveTo(this.x-this.width/4,this.y-this.height/4),ctx.lineTo(this.x-this.width/4,this.y+this.height/4),ctx.lineTo(this.x+this.width/4,this.y)):(ctx.moveTo(this.x-this.width/10+this.width/6,this.y+this.height/4),ctx.lineTo(this.x-this.width/10+this.width/6,this.y-this.height/4),ctx.lineTo(this.x+this.width/10+this.width/6,this.y-this.height/4),ctx.lineTo(this.x+this.width/10+this.width/6,this.y+this.height/4),ctx.moveTo(this.x-this.width/10-this.width/6,this.y+this.height/4),ctx.lineTo(this.x-this.width/10-this.width/6,this.y-this.height/4),ctx.lineTo(this.x+this.width/10-this.width/6,this.y-this.height/4),ctx.lineTo(this.x+this.width/10-this.width/6,this.y+this.height/4)),ctx.fillStyle="#ff9100",ctx.fill()},t.buttons[6].drawCenter=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/20-this.width/6,this.y+this.height/4),ctx.lineTo(this.x-this.width/20-this.width/6,this.y-this.height/4),ctx.lineTo(this.x+this.width/20-this.width/6,this.y-this.height/4),ctx.lineTo(this.x+this.width/20-this.width/6,this.y+this.height/4),ctx.moveTo(this.x,this.y-this.height/4),ctx.lineTo(this.x,this.y+this.height/4),ctx.lineTo(this.x+this.width/4,this.y),ctx.fillStyle="#ff9100",ctx.fill()}}},{key:"update",value:function(){t.getCurrentMode().earlyUpdate()}},{key:"getCurrentMode",value:function(){switch(t.mode){case 0:return BuildMode;case 1:return WiringMode;case 2:return InteractionMode}}},{key:"zoom",value:function(e){t.zoomFactor*=e,t.negCircleR*=e,t.connectionWidth*=e,t.connectionGap*=e,t.origin[0]=(t.origin[0]-mouseX)*e+mouseX,t.origin[1]=(t.origin[1]-mouseY)*e+mouseY;var n,r=_createForOfIteratorHelper(gates);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.width*=e,o.height*=e,o.x=(o.x-mouseX)*e+mouseX,o.y=(o.y-mouseY)*e+mouseY,o.fontSize*=e}}catch(t){r.e(t)}finally{r.f()}}},{key:"getSnappedPosition",value:function(e,n){return e=(e-t.origin[0])/t.zoomFactor,n=(n-t.origin[1])/t.zoomFactor,e=t.GATE_SNAP_DIV_SIZE*Math.round(e/t.GATE_SNAP_DIV_SIZE),n=t.GATE_SNAP_DIV_SIZE*Math.round(n/t.GATE_SNAP_DIV_SIZE),[e=e*t.zoomFactor+t.origin[0],n=n*t.zoomFactor+t.origin[1]]}}]),t}();function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}_defineProperty(Interface,"BACKGROUND_COLOR","#353535"),_defineProperty(Interface,"BUTTON_SPACING",5),_defineProperty(Interface,"GATE_SNAP_DIV_SIZE",10),_defineProperty(Interface,"zoomFactor",void 0),_defineProperty(Interface,"mode",void 0),_defineProperty(Interface,"blockInputs",void 0),_defineProperty(Interface,"buttons",void 0),_defineProperty(Interface,"origin",void 0),_defineProperty(Interface,"negCircleR",void 0),_defineProperty(Interface,"connectionWidth",void 0),_defineProperty(Interface,"connectionGap",void 0);var BuildMode=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"init",value:function(){t.GATES_LIBRARY=gatesLibrary,t.buttons=[(new Button).setGraphicProperties(80,50,"Destroy","#ae110b").setOnClick(function(){return t.removeGate(t.selectedGate)}),(new Button).setGraphicProperties(80,30,"UP","#379f1f").setOnClick(function(){return t.selectorPosition=Math.max(0,t.selectorPosition-1)}),(new Button).setGraphicProperties(80,30,"DOWN","#379f1f").setOnClick(function(){return t.selectorPosition=Math.min(t.buttons.length-t.listLength-5,t.selectorPosition+1)}),(new Button).setGraphicProperties(150,60,"Create Custom Gate","#379f1f").setOnClick(function(){return CustomGate.openPopup()}),(new Button).setGraphicProperties(150,60,"Last Custom Gate","#379f1f").setOnClick(function(){return t.addGate(SerializerParser.parseCustomGate(t.lastCustomGate))}),(new Button).setGraphicProperties(80,80,"AND","#379f1f").setOnClick(function(){return t.addGate(GateFactory.AND(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"OR","#379f1f").setOnClick(function(){return t.addGate(GateFactory.OR(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"NOT","#379f1f").setOnClick(function(){return t.addGate(GateFactory.NOT(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"XOR","#379f1f").setOnClick(function(){return t.addGate(GateFactory.XOR(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"NOR","#379f1f").setOnClick(function(){return t.addGate(GateFactory.NOR(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"NAND","#379f1f").setOnClick(function(){return t.addGate(GateFactory.NAND(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"XNOR","#379f1f").setOnClick(function(){return t.addGate(GateFactory.XNOR(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"UP","#379f1f").setOnClick(function(){return t.addGate(GateFactory.UP(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"DOWN","#379f1f").setOnClick(function(){return t.addGate(GateFactory.DOWN(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"CLOCK","#379f1f").setOnClick(function(){return t.addGate(GateFactory.CLOCK(mouseX,mouseY,200))}),(new Button).setGraphicProperties(80,80,"INPUT","#379f1f").setOnClick(function(){return t.addGate(GateFactory.INPUT(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"OUTPUT","#379f1f").setOnClick(function(){return t.addGate(GateFactory.OUTPUT(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"SWITCH","#379f1f").setOnClick(function(){return t.addGate(GateFactory.SWITCH(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"NODE","#379f1f").setOnClick(function(){return t.addGate(GateFactory.NODE(mouseX,mouseY))}),(new Button).setGraphicProperties(80,80,"CUSTOM","#379f1f").setOnClick(function(){return t.openCustomGatePopup()})],t.buttons[1].drawCenter=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/8,this.y+this.height/8),ctx.lineTo(this.x+this.width/8,this.y+this.height/8),ctx.lineTo(this.x,this.y-this.height/8),ctx.moveTo(this.x-this.width/8,this.y-this.height/8),ctx.fillStyle="#379f1f",ctx.fill()},t.buttons[2].drawCenter=function(){ctx.beginPath(),ctx.moveTo(this.x-this.width/8,this.y-this.height/8),ctx.lineTo(this.x+this.width/8,this.y-this.height/8),ctx.lineTo(this.x,this.y+this.height/8),ctx.moveTo(this.x-this.width/8,this.y-this.height/8),ctx.fillStyle="#379f1f",ctx.fill()}}},{key:"enable",value:function(){Interface.mode=0,t.selectedGate=null}},{key:"earlyUpdate",value:function(){if(t.selectedGate)if(shiftPressed){var e=Interface.getSnappedPosition(mouseX,mouseY);t.selectedGate.x=e[0],t.selectedGate.y=e[1]}else t.selectedGate.x=mouseX,t.selectedGate.y=mouseY}},{key:"lateUpdate",value:function(){var e,n=_createForOfIteratorHelper(t.buttons);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.x=-100,r.y=-100}}catch(t){n.e(t)}finally{n.f()}t.buttons[0].x=canvas.width-t.buttons[0].width/2-Interface.BUTTON_SPACING,t.buttons[0].y=canvas.height-t.buttons[0].height/2-Interface.BUTTON_SPACING,t.buttons[0].draw(),t.listLength=Math.floor((canvas.height-t.buttons[0].height-2*t.buttons[1].height-5*Interface.BUTTON_SPACING)/(t.buttons[5].height+Interface.BUTTON_SPACING)),t.listLength=Math.min(t.listLength,t.buttons.length-5),t.buttons[1].x=canvas.width-t.buttons[1].width/2-Interface.BUTTON_SPACING,t.buttons[1].y=t.buttons[1].height/2+Interface.BUTTON_SPACING,t.buttons[2].x=canvas.width-t.buttons[2].width/2-Interface.BUTTON_SPACING,t.buttons[2].y=t.buttons[5].height*t.listLength+1.5*t.buttons[1].height+Interface.BUTTON_SPACING*(2+t.listLength),t.buttons[1].draw(),t.buttons[2].draw(),5+t.selectorPosition+t.listLength-1>=t.buttons.length&&(t.selectorPosition=t.buttons.length-t.listLength-5);for(var o=0;o<t.listLength&&!(t.selectorPosition+o+5>t.buttons.length);o++)t.buttons[t.selectorPosition+o+5].x=canvas.width-t.buttons[5].width/2-Interface.BUTTON_SPACING,t.buttons[t.selectorPosition+o+5].y=t.buttons[1].height+(o+.5)*t.buttons[5].height+(o+2)*Interface.BUTTON_SPACING,t.buttons[t.selectorPosition+o+5].draw();t.buttons[3].x=t.buttons[3].width/2+Interface.BUTTON_SPACING,t.buttons[3].y=canvas.height-t.buttons[3].height/2-Interface.BUTTON_SPACING,""!==t.lastCustomGate?(t.buttons[4].x=t.buttons[3].width+t.buttons[4].width/2+2*Interface.BUTTON_SPACING,t.buttons[4].y=canvas.height-t.buttons[4].height/2-Interface.BUTTON_SPACING,t.buttons[4].draw()):(t.buttons[4].x=-100,t.buttons[4].y=-100),t.buttons[3].draw()}},{key:"onClick",value:function(){null!==t.selectedGate?t.selectedGate=null:t.selectedGate=Tools.getGateAtPosition(mouseX,mouseY)}},{key:"onKeyPressed",value:function(e){if("Delete"===e&&t.removeGate(t.selectedGate),"a"===e&&t.addGate(GateFactory.AND(mouseX,mouseY),!1),"o"===e&&t.addGate(GateFactory.OR(mouseX,mouseY),!1),"n"===e&&t.addGate(GateFactory.NOT(mouseX,mouseY),!1),"x"===e&&t.addGate(GateFactory.XOR(mouseX,mouseY),!1)," "===e)if("CUSTOM"===t.lastGate)t.addGate(SerializerParser.parseCustomGate(t.lastCustomGate),!1);else if(""!==t.lastGate){var n=GateFactory[t.lastGate];t.addGate(n(mouseX,mouseY),!1)}}},{key:"openCustomGatePopup",value:function(){Popup.open(),Popup.addTitle("Custom Gate"),Popup.addText("Data for your gate (you can generate it with the Build Custom Gate button)");var e=Popup.addFields([{id:"rawData"}]," ")[1];Popup.addSpace(2),Popup.addText("Gates library:"),Popup.addButtons(t.GATES_LIBRARY.map(function(t){return{clickEvent:function(){e.value=t.code},title:t.name}})," "),Popup.addDoneButton(function(){var e=SerializerParser.parseCustomGate(document.getElementById("rawData").value);e&&(t.addGate(e),t.lastCustomGate=e.string,Popup.close())})}},{key:"addGate",value:function(e,n){(void 0===n||n)&&(t.selectedGate=e),e.id=Gate.nextID,Gate.nextID++,t.lastGate=e.type,gates.push(e)}},{key:"removeGate",value:function(e){if(gates=gates.remove(e),t.selectedGate=null,e instanceof CustomGate){var n,r=_createForOfIteratorHelper(e.outputGates);try{for(r.s();!(n=r.n()).done;){var o=n.value;Gate.removeAllConnectionsTo(o,gates)}}catch(t){r.e(t)}finally{r.f()}}else Gate.removeAllConnectionsTo(e,gates)}}]),t}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}_defineProperty(BuildMode,"GATES_LIBRARY",void 0),_defineProperty(BuildMode,"selectedGate",null),_defineProperty(BuildMode,"selectorPosition",0),_defineProperty(BuildMode,"listLength",0),_defineProperty(BuildMode,"lastCustomGate",""),_defineProperty(BuildMode,"lastGate",""),_defineProperty(BuildMode,"buttons",void 0);var InteractionMode=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"init",value:function(){t.buttons=[]}},{key:"enable",value:function(){Interface.mode=2}},{key:"earlyUpdate",value:function(){}},{key:"lateUpdate",value:function(){}},{key:"onClick",value:function(){var t=Tools.getGateAtPosition(mouseX,mouseY);t&&t.onClick()}},{key:"onKeyPressed",value:function(t){}}]),t}();function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}_defineProperty(InteractionMode,"buttons",void 0);var WiringMode=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"init",value:function(){t.buttons=[]}},{key:"enable",value:function(){Interface.mode=1,t.selectedOutput=void 0,t.selectedInput=void 0}},{key:"earlyUpdate",value:function(){if(t.selectedOutput||t.selectedInput){var e=t.selectedInput?t.selectedInput.getInputPosition(t.inputIndex):[t.selectedOutput.x+t.selectedOutput.width/2-Interface.connectionWidth,t.selectedOutput.y],n=t.findClosestConnectionSlot(void 0!==t.selectedOutput),r=void 0!==n?[n.x,n.y]:[mouseX,mouseY];ctx.beginPath(),ctx.strokeStyle="#d3d3d3",ctx.lineWidth=Interface.connectionWidth,ctx.moveTo(e[0],e[1]),ctx.lineTo(r[0],r[1]),ctx.stroke()}}},{key:"lateUpdate",value:function(){if(t.selectedOutput||t.selectedInput){var e=t.findClosestConnectionSlot(void 0!==t.selectedOutput);e&&Tools.fillCircle(e.x,e.y,10*Interface.zoomFactor,"rgba(255, 255, 255, 0.5)",!1)}else{var n=t.findClosestConnectionSlot();n&&Tools.fillCircle(n.x,n.y,10*Interface.zoomFactor,"rgba(255, 255, 255, 0.5)",!1)}}},{key:"onClick",value:function(){t.handleClick()}},{key:"onKeyPressed",value:function(t){}},{key:"findClosestConnectionSlot",value:function(e){var n=void 0,r=1/0;function o(e){var o=Tools.sqr(mouseX-e.x)+Tools.sqr(mouseY-e.y);o<Tools.sqr(t.AUTO_SNAP_RANGE*Interface.zoomFactor)&&o<r&&(r=o,n=e)}var i,a=_createForOfIteratorHelper(gates);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(void 0===e||e)for(var u=0;u<s.maxInputs;u++){var c=s.getInputPosition(u);o({x:c[0],y:c[1],gate:s,index:u,isInput:!0})}if(void 0===e||!e)for(var l=0;l<s.maxOutputs;l++){var f=s.getOutputPosition(l);o({x:f[0],y:f[1],gate:s,index:l,isInput:!1})}}}catch(t){a.e(t)}finally{a.f()}return n}},{key:"handleClick",value:function(){var e=void 0;t.selectedInput&&(e=!1),t.selectedOutput&&(e=!0);var n=t.findClosestConnectionSlot(e);return n?!t.selectedInput&&!t.selectedOutput&&n.isInput&&n.gate.inputs[n.index]?(t.selectedOutput=n.gate.inputs[n.index].destination,void(n.gate.inputs[n.index]=void 0)):(t.selectedOutput||n.isInput||(t.selectedOutput=n.gate.getGateForOutput(n.index)),!t.selectedInput&&n.isInput&&(t.selectedInput=n.gate,t.inputIndex=n.index),void(t.selectedInput&&t.selectedOutput&&(t.selectedInput.addInput(t.selectedOutput,t.inputIndex),t.selectedOutput=void 0,t.selectedInput=void 0))):(t.selectedOutput=void 0,void(t.selectedInput=void 0))}}]),t}();function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}_defineProperty(WiringMode,"AUTO_SNAP_RANGE",40),_defineProperty(WiringMode,"selectedOutput",void 0),_defineProperty(WiringMode,"selectedInput",void 0),_defineProperty(WiringMode,"inputIndex",void 0),_defineProperty(WiringMode,"buttons",void 0);var Popup=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"open",value:function(){t.containerDiv=document.createElement("DIV"),t.mainDiv.appendChild(t.containerDiv),popupBackground.style.display="block",Interface.blockInputs=!0}},{key:"close",value:function(){t.containerDiv=void 0;for(var e=t.mainDiv.lastElementChild;e;)t.mainDiv.removeChild(e),e=t.mainDiv.lastElementChild;popupBackground.style.display="none",Interface.blockInputs=!1}},{key:"closeIfClickedOnBackground",value:function(){mouseX>.1*canvas.width&&mouseX<.9*canvas.width&&mouseY>.1*canvas.height&&mouseY<.9*canvas.height||t.close()}},{key:"addFields",value:function(e,n){var r=t.containerDiv,o=[];if(n){var i=document.createElement("P");i.innerHTML=n+" ",i.classList.add("popupElementTitle"),t.containerDiv.appendChild(i),r=i,o.push(i)}var a,s=_createForOfIteratorHelper(e);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=document.createElement("INPUT");u.id&&(c.id=u.id),c.value=u.defaultValue||"",c.classList.add("popupInput"),r.appendChild(c),o.push(c)}}catch(t){s.e(t)}finally{s.f()}return o}},{key:"addButtons",value:function(e,n){var r=t.containerDiv,o=[];if(n){var i=document.createElement("P");i.innerHTML=n,i.classList.add("popupElementTitle"),t.containerDiv.appendChild(i),r=i,o.push(i)}var a,s=_createForOfIteratorHelper(e);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=document.createElement("BUTTON");c.innerHTML=u.title,c.addEventListener("click",u.clickEvent),c.classList.add("popupButton"),r.appendChild(c),o.push(c)}}catch(t){s.e(t)}finally{s.f()}return o}},{key:"addDoneButton",value:function(e){var n=document.createElement("BUTTON");return n.innerHTML="Done",n.addEventListener("click",e||t.close),n.classList.add("popupDoneButton"),t.containerDiv.appendChild(n),n}},{key:"addTitle",value:function(e){var n=document.createElement("HR");return n.innerHTML=e,n.classList.add("popupTitle"),t.containerDiv.appendChild(n),n}},{key:"addSpace",value:function(e){void 0===e&&(e=1);for(var n=[],r=0;r<e;r++)n.push(t.addText("<br>"));return n}},{key:"addText",value:function(e){var n=document.createElement("P");return n.innerHTML=e,n.classList.add("popupText"),t.containerDiv.appendChild(n),n}},{key:"openError",value:function(e){t.open(),t.addTitle("Error"),t.addSpace(),t.addText(e),t.addDoneButton()}}]),t}();_defineProperty(Popup,"mainDiv",document.getElementById("popup_main_div")),_defineProperty(Popup,"containerDiv",void 0);var mouseX=0,mouseY=0;document.addEventListener("mousemove",function(t){mouseX=t.clientX-canvas.offsetLeft,mouseY=t.clientY-canvas.offsetTop}),document.addEventListener("click",function(){if(!Interface.blockInputs){var t=Interface.getButtonAtPosition(mouseX,mouseY);t?t.onClick():Interface.getCurrentMode().onClick()}}),document.addEventListener("touchstart",function(t){mouseX=t.changedTouches[0].pageX,mouseY=t.changedTouches[0].pageY,document.dispatchEvent(new Event("click"))}),document.addEventListener("touchend",function(t){mouseX=t.changedTouches[0].pageX,mouseY=t.changedTouches[0].pageY,document.dispatchEvent(new Event("click"))}),document.addEventListener("touchmove",function(t){mouseX=t.changedTouches[0].pageX,mouseY=t.changedTouches[0].pageY});var shiftPressed=!1,rightArrowPressed=!1;document.onkeyup=function(t){"Shift"===t.key&&(shiftPressed=!1),"ArrowRight"===t.key&&(rightArrowPressed=!1)},document.onkeydown=function(t){switch(t.key){case"Escape":Popup.close();break;case"Shift":shiftPressed=!0;break;case"ArrowRight":rightArrowPressed=!0}if(!Interface.blockInputs){switch(t.key){case"b":BuildMode.enable();break;case"w":WiringMode.enable();break;case"i":InteractionMode.enable()}Interface.getCurrentMode().onKeyPressed(t.key)}},canvas.addEventListener("wheel",function(t){Interface.blockInputs||Interface.zoom(1-t.deltaY/1e3)});
</script>

</body>
</html>
